<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7" lang="en-us"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8" lang="en-us"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if IE 9]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if lt IE 10]> <html class="no-js lt-ie10" lang="en-us"> <![endif]-->
<!--[if !IE]> > <![endif]-->
<html class='no-js' lang='en'>
<!-- <![endif] -->
<head>
<title>
Advanced oVirt Engine Build Notes &mdash;
oVirt
</title>
<meta charset='utf-8'>
<meta content='' name='description'>
<meta content='' name='author'>
<meta content='initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width' name='viewport'>

<link href='/images/favicon.ico' rel='shortcut icon'>
<link href='/images/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'>
<link href='/images/apple-touch-icon-57x57-precomposed.png' rel='apple-touch-icon-precomposed' sizes='57x57'>
<link href='/images/apple-touch-icon-72x72-precomposed.png' rel='apple-touch-icon-precomposed' sizes='72x72'>
<link href='/images/apple-touch-icon-114x114-precomposed.png' rel='apple-touch-icon-precomposed' sizes='114x114'>
<link href="/stylesheets/application.css?1447607916" rel="stylesheet" type="text/css" />
<link href="/stylesheets/print.css?1447607916" rel="stylesheet" type="text/css" media="print" />
</head>
<body class=' source-md'>
<header class='masthead hidden-print' id='branding' role='banner'>
<section class='hgroup'>
<h1>
<a href="/"><img id="logo" class="logo is-svg" alt="oVirt" src="/images/logo.svg?1447607917" />
</a></h1>
</section>
<div id='access'>
<nav role='navigation'>
<ul class='nav nav-pills'>
<li class='nav-link-home' role='menuitem'>
<a href='/'>Home</a>
</li>

<li class='nav-link-download' role='menuitem'>
<a href='/download/'>Download</a>
</li>

<li class='nav-link-documentation' role='menuitem'>
<a href='/documentation/'>Documentation</a>
</li>

<li class='nav-link-community' role='menuitem'>
<a href='/community/'>Community</a>
</li>

<li class='nav-link-develop' role='menuitem'>
<a href='/develop/'>Develop</a>
</li>

<li class='nav-link-search' role='menuitem'>
<a href='/search/'>Search</a>
</li>

</ul>
</nav>

</div>
</header>

<section class='page-wrap' id='page-wrap'>
<section class='page' id='page'>
<section class='container content' id='content'>
<div class='alert alert-warning'>
<div class='pull-right'>
<a>Hover for more info</a>
</div>
<div class='frontmatter-metadata'>
<table class='metadata'>
<caption>Frontmatter Metadata</caption>
<tr>
<th>title</th>
<td>Advanced oVirt Engine Build Notes</td>
</tr>
<tr>
<th>category</th>
<td>draft-documentation</td>
</tr>
<tr>
<th>authors</th>
<td>abonas, alonbl, amureini, asaf, dave chen, jhernand, ofrenkel</td>
</tr>
<tr>
<th>wiki_category</th>
<td>Draft documentation</td>
</tr>
<tr>
<th>wiki_title</th>
<td>Advanced oVirt Engine Build Notes</td>
</tr>
<tr>
<th>wiki_revision_count</th>
<td>18</td>
</tr>
<tr>
<th>wiki_last_updated</th>
<td>2013-05-12</td>
</tr>
</table>
</div>
Original Wiki page:
<a href='http://ovirt.org/Advanced_oVirt_Engine_Build_Notes' target='_blank'>
Advanced oVirt Engine Build Notes
</a>
</div>

<!--[if lt IE 7]>
<p class="chromeframe">You are using an outdated browser.
<a href="http://browsehappy.com/">Upgrade your browser today</a> or
<a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
<![endif]-->
<h1 id="advanced-ovirt-engine-build-notes">Advanced oVirt Engine Build Notes</h1>

<p><big><font color="lightgray" style="background-color: darkred">ATTENTION: This page is obsoleted for &gt;=ovirt-engine-3.3 by [oVirt Engine Development Environment](OVirt_Engine_Development_Environment)</font></big></p>

<h2 id="introduction">Introduction</h2>

<p>This page contains some notes regarding oVirt engine build system.</p>

<p>Please visit <a href="/documentation/draft/building-engine/">Building_oVirt_engine</a> for basic step by step instructions how to build oVirt engine.</p>

<h2 id="local-settings">Local Settings</h2>

<p>Maven supports local settings by creating a local <code>settings.xml</code> file that should be placed inside your <code>$HOME/.m2</code> directory.</p>

<p>You can find instructions how to create a basic <code>settings.xml</code> file in Building oVirt Engine in the <a href="/documentation/draft/building-engine/#Maven_personal_settings">Maven Personal Settings</a> section.</p>

<h2 id="gwt-compilation-configuration">GWT Compilation Configuration</h2>

<p>oVirt engine UI is based on GWT technology, Below are instructions how to tweak GWT compiler in order to speed up the development cycle.</p>

<h3 id="compiling-gwt-for-specific-browsers">Compiling GWT for specific browser(s)</h3>

<p>GWT compiler generates an application instance per supported browsers per locale, Since compiling to web mode takes a long time it is possible during development to compile to a specific browser (e.g Firefox) to speed up the compilation of WebAdmin web module,</p>

<p>This can be done by overriding the <code>gwt.userAgent</code> property. We recommend setting the <code>gwt.userAgent</code> property within the <code>gwtdev</code> profile. Edit <code>$HOME/.m2/settings.xml</code> file and add the following lines:</p>

<pre class="highlight plaintext"><code>&lt;profiles&gt;&#x000A;  &lt;profile&gt;&#x000A;    &lt;id&gt;gwtdev&lt;/id&gt;&#x000A;    &lt;properties&gt;&#x000A;      &lt;gwt.userAgent&gt;gecko1_8&lt;/gwt.userAgent&gt;&#x000A;    &lt;/properties&gt; &#x000A;  &lt;/profile&gt;&#x000A;&lt;/profiles&gt;&#x000A;</code></pre>

<ul>
  <li>Build oVirt Engine and enable the <code>gwtdev</code> profile:</li>
</ul>

<!-- -->

<pre class="highlight plaintext"><code>$ mvn install -Pdep,gwtdev,gwt-admin&#x000A;</code></pre>

<p>This will instruct GWT to generate 1 permutation for Firefox browser only. If you need to build for other browsers you can use the following values inside the <code>gwt.userAgent</code> property:</p>

<ul>
  <li>For Firefox: <code>gecko1_8</code></li>
  <li>For Internet Explorer 6: <code>ie6</code></li>
  <li>For Internet Explorer 8: <code>ie8</code></li>
  <li>For Internet Explorer 9: <code>ie9</code></li>
  <li>For Safari and Chrome: <code>safari</code></li>
  <li>For Opera: <code>opera</code></li>
</ul>

<p>For example, if you want to build for both Firefox and Chrome you can use the following:</p>

<pre class="highlight plaintext"><code>&lt;profiles&gt;&#x000A;  &lt;profile&gt;&#x000A;    &lt;id&gt;gwtdev&lt;/id&gt;&#x000A;    &lt;properties&gt;&#x000A;      &lt;gwt.userAgent&gt;gecko1_8,safari&lt;/gwt.userAgent&gt;&#x000A;    &lt;/properties&gt; &#x000A;  &lt;/profile&gt;&#x000A;&lt;/profiles&gt;&#x000A;</code></pre>

<p>Alternatively, if you don't want to modify your <code>$HOME/.m2/settings.xml</code> file, you can set the property in the command line. For example to build WebAdmin for Firefox and Chrome you can use the following command:</p>

<pre class="highlight plaintext"><code>$ mvn install -Dgwt.userAgent=gecko1_8,safari -Pgwt-admin&#x000A;</code></pre>

<h2 id="testing-daos">Testing DAOs</h2>

<p>By default, the DAO tests are not run during <code>mvn install</code>, since they require an actual PostgreSQL database to run on. In order to run them, you should follow these instructions.</p>

<p>First, you must create a database to use for the tests. This database's credentials are defined in <code>$OVIRT_GIT/backend/manager/modules/dal/src/test/filters/pgsql.properties</code>. By default the tests are run on a database called <code>engine_test</code> by the <code>postgres</code> user (you can, of course, change these details in your own environment. To create this database, perform the following:</p>

<pre class="highlight plaintext"><code>$ cd $OVIRT_GIT/backend/manager/dbscripts&#x000A;$ ./create_db_devel.sh -d engine_test -u postgres&#x000A;</code></pre>

<p>In order to run the tests, you will have to enable the <code>enable-dao-tests</code> profile:</p>

<pre class="highlight plaintext"><code>$ cd $OVIRT_GIT/backend/manager/modules/dal&#x000A;$ mvn install -Penable-dao-tests&#x000A;</code></pre>

<p>Note: you may use the <code>enable-dao-tests</code> profile on higher levels than the <code>dal</code> module, such as when building the engine's root.</p>

<h2 id="skipping-unit-tests">Skipping Unit Tests</h2>

<p>It is possible during development to speed up the build process by skipping the execution of unit tests, This can be done by adding the <code>-DskipTests</code> to your build command:</p>

<pre class="highlight plaintext"><code>$ mvn install -DskipTests&#x000A;</code></pre>

<h2 id="log-configuration">Log Configuration</h2>

<p>Engine logging is done with log4j.
the configuration is done with jboss-log4j.xml file which can be found under <jboos profile="" dir="">/conf/
this file contains categories for main components, and log level can be changed there.
also 3rd parties components are configured in this file (like apache http client).
it is also possible to add appenders which allow logging some components to different files.
(this is useful when logging debug messages of component that may create a lot of 'noise' in the regular log).</jboos></p>

<p><a href="/documentation/draft-documentation/">Category:Draft documentation</a> <category:engine> [Category:How to](Category:How to)</category:engine></p>

</section>
</section>
</section>
<footer class='text-center' id='footer'>
<hr class='visible-print'>
<ul class='footer-nav-list'>
<li><a target="_blank" href="/privacy/">Privacy policy</a></li>
<li><a target="_blank" href="/about/">About</a></li>
<li><a target="_blank" href="/disclaimers/">Disclaimers</a></li>
</ul>

&copy; 2013&ndash;2015 oVirt
<div class='last-modified'>
Page last modified
Wed 11 Nov 2015 18:11 UTC
</div>
</footer>


<script src="/javascripts/application.js?1447607928" type="text/javascript"></script>

<!-- eloqua -->
<script src='http://www.redhat.com/j/elqNow/elqCfg.js' type='text/javascript'></script>
<script src='http://www.redhat.com/j/elqNow/elqImg.js' type='text/javascript'></script>

</body>
</html>
