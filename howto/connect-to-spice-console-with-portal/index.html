<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7" lang="en-us"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8" lang="en-us"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if IE 9]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if lt IE 10]> <html class="no-js lt-ie10" lang="en-us"> <![endif]-->
<!--[if !IE]> > <![endif]-->
<html class='no-js' lang='en'>
<!-- <![endif] -->
<head>
<title>
How to Connect to SPICE Console With Portal &mdash;
oVirt
</title>
<meta charset='utf-8'>
<meta content='' name='description'>
<meta content='' name='author'>
<meta content='initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width' name='viewport'>

<link href='/images/favicon.ico' rel='shortcut icon'>
<link href='/images/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'>
<link href='/images/apple-touch-icon-57x57-precomposed.png' rel='apple-touch-icon-precomposed' sizes='57x57'>
<link href='/images/apple-touch-icon-72x72-precomposed.png' rel='apple-touch-icon-precomposed' sizes='72x72'>
<link href='/images/apple-touch-icon-114x114-precomposed.png' rel='apple-touch-icon-precomposed' sizes='114x114'>
<link href="/stylesheets/application.css?1447607916" rel="stylesheet" type="text/css" />
<link href="/stylesheets/print.css?1447607916" rel="stylesheet" type="text/css" media="print" />
</head>
<body class=' source-md'>
<header class='masthead hidden-print' id='branding' role='banner'>
<section class='hgroup'>
<h1>
<a href="/"><img id="logo" class="logo is-svg" alt="oVirt" src="/images/logo.svg?1447607917" />
</a></h1>
</section>
<div id='access'>
<nav role='navigation'>
<ul class='nav nav-pills'>
<li class='nav-link-home' role='menuitem'>
<a href='/'>Home</a>
</li>

<li class='nav-link-download' role='menuitem'>
<a href='/download/'>Download</a>
</li>

<li class='nav-link-documentation' role='menuitem'>
<a href='/documentation/'>Documentation</a>
</li>

<li class='nav-link-community' role='menuitem'>
<a href='/community/'>Community</a>
</li>

<li class='nav-link-develop' role='menuitem'>
<a href='/develop/'>Develop</a>
</li>

<li class='nav-link-search' role='menuitem'>
<a href='/search/'>Search</a>
</li>

</ul>
</nav>

</div>
</header>

<section class='page-wrap' id='page-wrap'>
<section class='page' id='page'>
<section class='container content' id='content'>
<div class='alert alert-warning'>
<div class='pull-right'>
<a>Hover for more info</a>
</div>
<div class='frontmatter-metadata'>
<table class='metadata'>
<caption>Frontmatter Metadata</caption>
<tr>
<th>title</th>
<td>How to Connect to SPICE Console With Portal</td>
</tr>
<tr>
<th>category</th>
<td>howto</td>
</tr>
<tr>
<th>authors</th>
<td>alonbl, deadhorseconsulting, digisign, gianluca</td>
</tr>
<tr>
<th>wiki_title</th>
<td>How to Connect to SPICE Console With Portal</td>
</tr>
<tr>
<th>wiki_revision_count</th>
<td>14</td>
</tr>
<tr>
<th>wiki_last_updated</th>
<td>2013-10-02</td>
</tr>
</table>
</div>
Original Wiki page:
<a href='http://ovirt.org/How_to_Connect_to_SPICE_Console_With_Portal' target='_blank'>
How to Connect to SPICE Console With Portal
</a>
</div>

<!--[if lt IE 7]>
<p class="chromeframe">You are using an outdated browser.
<a href="http://browsehappy.com/">Upgrade your browser today</a> or
<a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
<![endif]-->
<h1 id="how-to-connect-to-spice-console-with-portal">How to Connect to SPICE Console With Portal</h1>

<p>This article will explain how to connect to a SPICE console from either the User or Admin Portal using the SPICE Remote-Viewer Client/ActiveX Plugin.</p>

<h2 id="under-the-hood">Under the Hood</h2>

<p>So what happens when you hit the "Console" button?</p>

<ol>
  <li>ovirt-engine sets a new password and it's expiry time (by default 120 s) which compose together a ticket</li>
  <li>ovirt-engine looks up other connection details (more on them later) in its database</li>
  <li>ovirt-engine passes all the connection info to the portal</li>
  <li>portal sets variables on application/x-spice object</li>
  <li>Internet Explorer passes variables info to the spice client (Remote-Viewer) via the ActiveX plugin (SpiceX.dll) and launches it</li>
  <li>spice client (Remote-Viewer) connects directly to a host using data given to it by the portal</li>
</ol>

<h2 id="assumptions-and-prerequisities">Assumptions and Prerequisities</h2>

<ul>
  <li>An installed and running instance of ovirt-engine See: <a href="/engine/installing-engine-from-rpm/">Installing_ovirt-engine_from_rpm</a></li>
  <li>One or two nodes within an active cluster, EL6 or Fedora nodes are both fine.</li>
  <li>You want to connect to you guest console using SPICE!</li>
  <li>You are connecting from a Windows based Box/VM.</li>
  <li>You are running one of the following Microsoft Windows versions:
    <ul>
      <li>Microsoft Windows XP (x86)</li>
      <li>Windows Vista (x86/x64)</li>
      <li>Windows 7 (x86/x64)</li>
      <li>Server 2003/R2 (x86/x64)</li>
      <li>Server 2008/R2 (x86/x64)</li>
    </ul>
  </li>
</ul>

<h2 id="gettingprepping-the-remote-viewer-clientactivex-plugin">Getting/Prepping the Remote-Viewer Client/ActiveX Plugin</h2>

<h3 id="get-the-cabinet-file">Get the Cabinet File</h3>

<ul>
  <li>Start by downloading: <a href="http://elmarco.fedorapeople.org/spice.cab">spice.cab</a></li>
</ul>

<h3 id="prepping-the-files">Prepping the Files</h3>

<ul>
  <li>Under windows extract the contents of the cabinet file</li>
  <li>From the files extracted the one we are interested in is the executable installer file virt-viewer-<version>.exe (this will used in the case of the need for a manual client deployment)</version></li>
  <li>Rename spice.cab to SpiceX.cab</li>
  <li>Save these files somewhere where you can get to them from the system on which you are running your ovirt-engine instance</li>
</ul>

<h2 id="installing-things-server-side">Installing things Server Side</h2>

<h3 id="installing-the-files">Installing the Files</h3>

<ul>
  <li>Login into the system on which you are running your ovirt-engine instance</li>
  <li>Create a directory for the files to be hosted in, the ovirt-engine by default uses "/usr/share/spice"</li>
  <li>Place the SpiceX.cab file and the virt-viewer-<version>.exe files in /usr/share/spice</version></li>
</ul>

<h3 id="make-jboss-aware-of-the-files">Make JBoss aware of the Files</h3>

<h4 id="ovirt-engine-331-and-newer">ovirt-engine-3.3.1 and newer</h4>

<ol>
  <li>. Put spice artifacts (cabs) into a directory, example /usr/share/spice</li>
  <li>. Create symlink /usr/share/ovirt-engine/files/spice -&gt; /usr/share/spice</li>
</ol>

<h4 id="ovirt-engine-330-and-older">ovirt-engine-3.3.0 and older</h4>

<ul>
  <li>You will now need to let JBoss know how to host, where to host and what type of files these are</li>
  <li>This will require the following modifications to /usr/share/ovirt-engine/engine.ear/root.war/WEB-INF/web.xml</li>
  <li>Open /usr/share/ovirt-engine/engine.ear/root.war/WEB-INF/web.xml and make the following modifications:</li>
</ul>

<p>Add a <servlet> definition for SpiceX.cab</servlet></p>

<pre class="highlight plaintext"><code>  &lt;!-- SpiceX.cab --&gt;&#x000A;  &lt;servlet&gt;&#x000A;    &lt;servlet-name&gt;SpiceX.cab&lt;/servlet-name&gt;&#x000A;    &lt;servlet-class&gt;org.ovirt.engine.core.FileServlet&lt;/servlet-class&gt;&#x000A;  &lt;init-param&gt;&#x000A;    &lt;param-name&gt;type&lt;/param-name&gt;&#x000A;    &lt;param-value&gt;application/octet-stream&lt;/param-value&gt;&#x000A;  &lt;/init-param&gt;&#x000A;  &lt;init-param&gt;&#x000A;    &lt;param-name&gt;file&lt;/param-name&gt;&#x000A;    &lt;param-value&gt;/usr/share/spice/SpiceX.cab&lt;/param-value&gt;&#x000A;  &lt;/init-param&gt;&#x000A;  &lt;/servlet&gt;&#x000A;  &lt;servlet-mapping&gt;&#x000A;    &lt;servlet-name&gt;SpiceX.cab&lt;/servlet-name&gt;&#x000A;    &lt;url-pattern&gt;/spice/SpiceX.cab&lt;/url-pattern&gt;&#x000A;  &lt;/servlet-mapping&gt;&#x000A;</code></pre>

<p>Add a <servlet> definition for virt-viewer-<version>.exe</version></servlet></p>

<pre class="highlight plaintext"><code>  &lt;!-- virt-viewer-&lt;version&gt;.exe --&gt;&#x000A;  &lt;servlet&gt;&#x000A;    &lt;servlet-name&gt;virt-viewer-&lt;version&gt;.exe&lt;/servlet-name&gt;&#x000A;    &lt;servlet-class&gt;org.ovirt.engine.core.FileServlet&lt;/servlet-class&gt;&#x000A;  &lt;init-param&gt;&#x000A;    &lt;param-name&gt;type&lt;/param-name&gt;&#x000A;    &lt;param-value&gt;application/octet-stream&lt;/param-value&gt;&#x000A;  &lt;/init-param&gt;&#x000A;  &lt;init-param&gt;&#x000A;    &lt;param-name&gt;file&lt;/param-name&gt;&#x000A;    &lt;param-value&gt;/usr/share/spice/virt-viewer-&lt;version&gt;.exe&lt;/param-value&gt;&#x000A;  &lt;/init-param&gt;&#x000A;  &lt;/servlet&gt;&#x000A;  &lt;servlet-mapping&gt;&#x000A;    &lt;servlet-name&gt;virt-viewer-&lt;version&gt;.exe&lt;/servlet-name&gt;&#x000A;    &lt;url-pattern&gt;/spice/virt-viewer-&lt;version&gt;.exe&lt;/url-pattern&gt;&#x000A;  &lt;/servlet-mapping&gt;&#x000A;</code></pre>

<ul>
  <li>Don't forget to replace <version> in virt-viewer-<version>.exe with the version for example: virt-viewer-0.5.3.exe</version></version></li>
  <li>Close and save web.xml</li>
  <li>NOTE the file web.xml is part of ovirt-engine-backend rpm; in oVirt 3.2 the <servlet> definition for SpiceX.cab is already in place</servlet></li>
  <li>NOTE you will need to restart jboss-as to have the changes you just made picked up (EG: systemctl restart ovirt-engine.service)</li>
</ul>

<h2 id="add-a-deployment-method-server-side">Add a deployment method Server Side</h2>

<h3 id="create-a-web-page-to-deploy-the-cabinetexe-files">Create a web page to deploy the cabinet/exe Files</h3>

<ul>
  <li>As of oVirt 3.1 the code within the engine to automatically check/deploy the ActiveX Plugin was disabled. See ovirt-engine source file: frontend/webadmin/modules/gwt-common/src/main/java/org/ovirt/engine/ui/common/uicommon/SpiceInterfaceImpl.java</li>
  <li>Given the prior the best way at the moment to do deploy to clients is to create a web page which will deploy/ allow download of the files to users</li>
  <li>Thus we will need to whip up a page which can deploy or provide download of the files and which clients can access via the server on which JBoss/ovirt-engine is running</li>
  <li>Fire up your favorite text editor and copy/paste the below:</li>
</ul>

<p>Example simple html/java script page for Remote-Viewer Client/ActiveX Plugin download/deployment</p>

<pre class="highlight html"><code>  <span class="cp">&lt;!DOCTYPE html&gt;</span>&#x000A;  <span class="nt">&lt;html&gt;</span>&#x000A;  <span class="nt">&lt;head&gt;</span>&#x000A;  <span class="nt">&lt;title&gt;</span>SPICE Remote Viewer Client/ActiveX Plugin<span class="nt">&lt;/title&gt;</span>&#x000A;  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"web-conf.js"</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>&#x000A;&#x000A;  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>&#x000A;  <span class="kd">function</span> <span class="nx">installSpice</span><span class="p">()</span>&#x000A;  <span class="p">{</span>&#x000A;  <span class="k">try</span> <span class="p">{</span>&#x000A;      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'SpiceX'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'&lt;OBJECT id="SpiceX" codebase="/spice/SpiceX.cab" classid="clsid:ACD6D89C-938D-49B4-8E81-DDBD13F4B48A" width="0" height="0"&gt;&lt;/OBJECT&gt;'</span><span class="p">;</span>&#x000A;  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ex</span><span class="p">)</span> <span class="p">{</span>&#x000A;      <span class="nx">alert</span><span class="p">(</span><span class="s2">"Epic Fail!: "</span> <span class="o">+</span> <span class="nx">ex</span><span class="p">.</span><span class="nx">Description</span><span class="p">);</span>&#x000A;  <span class="p">}</span>&#x000A;  <span class="p">}</span>&#x000A;  <span class="nt">&lt;/script&gt;</span>&#x000A;&#x000A;  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>&#x000A;  <span class="kd">function</span> <span class="nx">getHttpHref</span><span class="p">(</span><span class="nx">addedUrl</span><span class="p">,</span> <span class="nx">description</span><span class="p">)</span>&#x000A;  <span class="p">{</span>&#x000A;      <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s2">"&lt;a href=""+http_url+"</span><span class="o">/</span><span class="s2">"+addedUrl+""/&gt;"</span><span class="o">+</span><span class="nx">description</span><span class="o">+</span><span class="s2">"&lt;/a&gt;"</span><span class="p">);</span>&#x000A;  <span class="p">}</span>&#x000A;  <span class="nt">&lt;/script&gt;</span>&#x000A;&#x000A;  <span class="nt">&lt;/head&gt;</span>&#x000A;  <span class="nt">&lt;body&gt;</span>&#x000A;&#x000A;    <span class="nt">&lt;h1&gt;&lt;b&gt;&lt;p&gt;</span>Web Install<span class="nt">&lt;/p&gt;&lt;/b&gt;&lt;/h2&gt;</span>&#x000A;    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#web"</span><span class="nt">&gt;</span>Spice Remote-Viewer Client/ActiveX Plugin Web Installer<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>&#x000A;    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#web-install1"</span><span class="nt">&gt;</span>Windows XP (x86)/Server 2003/R2 (x86/x64) Web Install Instructions<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>&#x000A;    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#web-install2"</span><span class="nt">&gt;</span>Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Web Install Instructions<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>&#x000A;    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#web-uninstall1"</span><span class="nt">&gt;</span>Windows XP (x86)/Server 2003/R2 (x86/x64) Uninstall Instructions<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>&#x000A;    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#web-uninstall2"</span><span class="nt">&gt;</span>Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Uninstall Instructions<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>&#x000A;&#x000A;     <span class="nt">&lt;h1&gt;&lt;b&gt;&lt;p&gt;</span>Manual Install<span class="nt">&lt;/p&gt;&lt;/b&gt;&lt;/h2&gt;</span>&#x000A;    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#manual"</span><span class="nt">&gt;</span>Spice Remote-Viewer Client/ActiveX Plugin Manual Install<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>&#x000A;    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#manual-install1"</span><span class="nt">&gt;</span>Windows XP (x86)/Server 2003/R2 (x86/x64) Manual Install Instructions<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>&#x000A;    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#manual-install2"</span><span class="nt">&gt;</span>Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Manual Install Instructions<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>&#x000A;    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#manual-uninstall1"</span><span class="nt">&gt;</span>Windows XP (x86)/Server 2003/R2 (x86/x64) Uninstall Instructions<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>&#x000A;    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#manual-uninstall2"</span><span class="nt">&gt;</span>Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Uninstall Instructions<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>&#x000A;&#x000A;    <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">"web"</span><span class="nt">&gt;&lt;/a&gt;</span>&#x000A;    <span class="nt">&lt;h1&gt;&lt;b&gt;</span>Web Installer for Spice Remote-Viewer Client/ActiveX Plugin<span class="nt">&lt;/b&gt;&lt;/h1&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>This will attempt to install via your browser the Spice Remote-Viewer Client/ActiveX Plugin<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>Supported Browsers: Microsoft Internet Explorer - 32-bit<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>Supported Operating Systems: Microsoft Windows XP (x86),Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2003/R2 (x86/x64), Server 2008/R2 (x86/x64)<span class="nt">&lt;/p&gt;</span>&#x000A;&#x000A;    <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">"web-install1"</span><span class="nt">&gt;&lt;/a&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;&lt;b&gt;</span>Windows XP (x86)/Server 2003/R2 (x86/x64) Web Install Instructions:<span class="nt">&lt;/b&gt;&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>1) Click the Install Spice button<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>2) IE will prompt you with "This website wants to install the following add-on SpiceX.cab... proceed by clicking "Install this Add-on for All Users of this computer".<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>3) Depending on the version of IE the next security warning may pop up asking you if you want to install SpiceX.cab" If it does not Click on the install spice button again and it will.<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>4) In the security warning dialog click on the Install button.<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>5) The install will now proceed in the background.<span class="nt">&lt;p/&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>6) If the install was successful there will now be an entry called "VirtViewer" in your start menu under "All Programs".<span class="nt">&lt;p/&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>7) The Spice Remote-Viewer Client/ActiveX Plugin is now installed and you will be able to view the consoles of your vm's in the User/Admin portals.<span class="nt">&lt;/p&gt;</span>:&#x000A;&#x000A;    <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">"web-install2"</span><span class="nt">&gt;&lt;/a&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;&lt;b&gt;</span>Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Web Install Instructions:<span class="nt">&lt;/b&gt;&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>1) Click the install spice button<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>2) IE will prompt you with "This website wants to install the following add-on SpiceX.cab... proceed by clicking the arrow on the install button and choose "Install for All Users of this computer".<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>3) Depending on the version of IE a UAC dialog may pop up asking you if you want to allow "SpiceX.cab" If it does not Click on the install spice button again and it will.<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>4) In the UAC dialog click on the yes button.<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>5) The install will now proceed in the background.<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>6) If the install was successful there will now be an entry called "VirtViewer" in your start menu under "All Programs".<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>7) The Spice Remote-Viewer Client/ActiveX Plugin is now installed and you will be able to view the consoles of your vm's in the User/Admin portals.<span class="nt">&lt;/p&gt;</span>:&#x000A;&#x000A;    <span class="nt">&lt;p&gt;&lt;b</span> <span class="na">id=</span><span class="s">'SpiceX'</span><span class="nt">&gt;</span>Spice ActiveX Plugin Object<span class="nt">&lt;/b&gt;&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">'installSpice()'</span><span class="nt">&gt;</span>Install Spice<span class="nt">&lt;/button&gt;</span>&#x000A;&#x000A;    <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">"web-uninstall1"</span><span class="nt">&gt;&lt;/a&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;&lt;b&gt;</span>Windows XP (x86)/Server 2003/R2 (x86/x64) Uninstall Instructions:<span class="nt">&lt;/b&gt;&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>1) *Important* Close all open Internet Explorer windows/sessions!<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>2) Click on the start menu<span class="nt">&lt;/p&gt;</span>     &#x000A;    <span class="nt">&lt;p&gt;</span>3) Click "All Programs"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>4) Click "Accessories"&gt;<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>5) Click "Command Prompt"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>6) In the command prompt window type "regsvr32 /u "C:\Documents and Settings\yourusernamehere\Local Settings\Application Data\virt-viewer\bin\SpiceX.dll"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>7) Next Click on the start menu<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>8) Click "Control Panel"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>9) In the Control Panel run Add/Remove Programs<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>10) Click on VirtViewer and click on Change/Remove<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>11) The Spice Remote-Viewer Client/ActiveX Plugin is now uninstalled from the sytem<span class="nt">&lt;/p&gt;</span>&#x000A;&#x000A;    <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">"web-uninstall2"</span><span class="nt">&gt;&lt;/a&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;&lt;b&gt;</span>Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Uninstall Instructions:<span class="nt">&lt;/b&gt;&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>1) *Important* Close all open Internet Explorer windows/sessions!<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>2) Click on the start menu<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>3) Click "All Programs"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>4) Click "Accessories"&gt;<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>5) Click "Command Prompt"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>6) In the command prompt window type "regsvr32 /u "C:\Users\yourusernamehere\AppData\Local\virt-viewer\bin\SpiceX.dll"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>7) Next Click on the start menu<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>8) Click "Control Panel"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>9) In the Control Panel run "Programs and Features"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>10) Click on VirtViewer and click on Uninstall<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>11) The Spice Remote-Viewer Client/ActiveX Plugin is now uninstalled from the sytem<span class="nt">&lt;/p&gt;</span>    &#x000A;&#x000A;    <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">"manual"</span><span class="nt">&gt;&lt;/a&gt;</span>&#x000A;    <span class="nt">&lt;h1&gt;&lt;b&gt;</span>Manual installer for Spice Remote-Viewer Client/ActiveX Plugin<span class="nt">&lt;/b&gt;&lt;/h1&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>This is for manually installing the Spice Remote-Viewer Client/ActiveX Plugin<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>Supported Browsers: Microsoft Internet Explorer - 32-bit<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>Supported Operating Systems: Microsoft Windows XP (x86),Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2003/R2 (x86/x64), Server 2008/R2 (x86/x64)<span class="nt">&lt;/p&gt;</span>&#x000A;&#x000A;    <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">"manual-install1"</span><span class="nt">&gt;&lt;/a&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;&lt;b&gt;</span>Windows XP (x86)/Server 2003/R2 (x86/x64) Manual Install Instructions:<span class="nt">&lt;/b&gt;&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>1) Right-Click "Spice Remote-Viewer Client/ActiveX Plugin" and choose "save target as"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>2) Save the installer somewhere and note it's location<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>3) *Important* Close all open Internet Explorer windows/sessions!<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>4) Go to the location where you saved the installer and double-click it to launch it<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>5) A security warning will pop up warning of an un-verified publisher this is fine click on the run button to proceed<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>6) In the resulting installation dialog click on the install button to proceed with the install<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>7) Click the close button once it is done to complete the install<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>8) The Spice Remote-Viewer Client/ActiveX Plugin is now installed and you will be able to view the consoles of your vm's in the User/Admin portals.<span class="nt">&lt;/p&gt;</span>&#x000A;&#x000A;    <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">"manual-install2"</span><span class="nt">&gt;&lt;/a&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;&lt;b&gt;</span>Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Manual Install Instructions:<span class="nt">&lt;/b&gt;&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>1) Right-Click "Spice Remote-Viewer Client/ActiveX Plugin" and choose "save target as"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>2) Save the installer somewhere and note it's location<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>3) *Important* Close all open Internet Explorer windows/sessions!<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>4) Go to the location where you saved the installer and right-click it then choose "Run as Administrator"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>5) A UAC dialog will pop up asking you if you want to allow virt-viewer to install.<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>6) In the UAC dialog click on the yes button.<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>7) In the resulting installation dialog click on the install button to proceed with the install<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>8) Click the close button once it is done to complete the install<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>9) The Spice Remote-Viewer Client/ActiveX Plugin is now installed and you will be able to view the consoles of your vm's in the User/Admin portals.<span class="nt">&lt;/p&gt;</span>&#x000A;&#x000A;    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/JavaScript"</span><span class="nt">&gt;</span><span class="nx">getHttpHref</span><span class="p">(</span><span class="s2">"spice/virt-viewer-&lt;version&gt;.exe"</span><span class="p">,</span><span class="s2">"Spice Remote-Viewer Client/ActiveX Plugin"</span><span class="p">);</span><span class="nt">&lt;/script&gt;</span>&#x000A;&#x000A;    <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">"manual-uninstall1"</span><span class="nt">&gt;&lt;/a&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;&lt;b&gt;</span>Windows XP (x86)/Server 2003/R2 (x86/x64) Uninstall Instructions:<span class="nt">&lt;/b&gt;&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>1) *Important* Close all open Internet Explorer windows/sessions!<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>2) Click on the start menu<span class="nt">&lt;/p&gt;</span>     &#x000A;    <span class="nt">&lt;p&gt;</span>3) Click "All Programs"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>4) Click "Accessories"&gt;<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>5) Click "Command Prompt"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>6) In the command prompt window type "regsvr32 /u "C:\Documents and Settings\yourusernamehere\Local Settings\Application Data\virt-viewer\bin\SpiceX.dll"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>7) Next Click on the start menu<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>8) Click "Control Panel"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>9) In the Control Panel run Add/Remove Programs<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>10) Click on VirtViewer and click on Change/Remove<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>11) The Spice Remote-Viewer Client/ActiveX Plugin is now uninstalled from the sytem<span class="nt">&lt;/p&gt;</span>&#x000A;&#x000A;    <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">"manual-uninstall2"</span><span class="nt">&gt;&lt;/a&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;&lt;b&gt;</span>Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Uninstall Instructions:<span class="nt">&lt;/b&gt;&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>1) *Important* Close all open Internet Explorer windows/sessions!<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>2) Click on the start menu<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>3) Click "All Programs"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>4) Click "Accessories"&gt;<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>5) Click "Command Prompt"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>6) In the command prompt window type "regsvr32 /u "C:\Users\yourusernamehere\AppData\Local\virt-viewer\bin\SpiceX.dll"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>7) Next Click on the start menu<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>8) Click "Control Panel"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>9) In the Control Panel run "Programs and Features"<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>10) Click on VirtViewer and click on Uninstall<span class="nt">&lt;/p&gt;</span>&#x000A;    <span class="nt">&lt;p&gt;</span>11) The Spice Remote-Viewer Client/ActiveX Plugin is now uninstalled from the sytem<span class="nt">&lt;/p&gt;</span>&#x000A;&#x000A;  <span class="nt">&lt;/body&gt;</span>&#x000A;  <span class="nt">&lt;/html&gt;</span>&#x000A;</code></pre>

<ul>
  <li>Don't forget to replace <version> in virt-viewer-<version>.exe with the version for example: virt-viewer-0.5.3.exe</version></version></li>
  <li>Don't forget to replace "yourusernamehere" with your windows username for example "C:\Users\thrall\AppData\Local\virt-viewer\bin\SpiceX.dll"</li>
  <li>save the file as filename.html Example: "spice.html"</li>
</ul>

<h3 id="installing-the-web-page">Installing the web page</h3>

<ul>
  <li>To install the web page copy it to /usr/share/ovirt-engine/engine.ear/root.war</li>
</ul>

<h3 id="accessing-the-web-page">Accessing the web page</h3>

<ul>
  <li>The page will now be accessible via the url to your ovirt-engine instance</li>
  <li>Example URL
    http://ovirt.azeroth.net/spice.html</li>
</ul>

<h3 id="modify-ovirt-main-page">Modify oVirt main page</h3>

<ul>
  <li>Optionally you can modify the main oVirt page to contain a link to your deployment page</li>
  <li>You will need to modify /usr/share/ovirt-engine/engine.ear/root.war/index.html</li>
</ul>

<p>Add an entry to the below section of index.html containing the links to the various portals:</p>

<pre class="highlight plaintext"><code>                &lt;div id='dynamicLinksSection' style="display: none;"&gt;&#x000A;                        &lt;div&gt;&#x000A;                        &lt;h2&gt;&#x000A;                                &lt;span class="fakeH2"&gt;Portals&lt;/span&gt;&#x000A;                        &lt;/h2&gt;&#x000A;                                &lt;div&gt;&lt;a href="UserPortal"&gt;User Portal&lt;/a&gt;&lt;/div&gt;&#x000A;                                &lt;div&gt;&lt;a href="webadmin"&gt;Administrator Portal&lt;/a&gt;&lt;/div&gt;&#x000A;                                &lt;div&gt;&lt;a href="OvirtEngineWeb/RedirectServlet?Page=Reports"&gt;Reports Portal&lt;/a&gt;&lt;/div&gt;&#x000A;                                &lt;div&gt;&lt;a href="spice.html"&gt;Spice Install Portal&lt;/a&gt;&lt;/div&gt;&#x000A;                        &lt;/div&gt;&#x000A;                &lt;/div&gt;&#x000A;</code></pre>

<h2 id="installing-via-the-web-client-side">Installing via the web Client Side</h2>

<h3 id="windows-xp-x86server-2003r2-x86x64-clients">Windows XP (x86)/Server 2003/R2 (x86/x64) Clients</h3>

<ul>
  <li>Launch Internet Explorer and browse to your oVirt instance and according spice.html</li>
  <li>
    <p>Example URL
    http://ovirt.azeroth.net/spice.html</p>
  </li>
  <li>Click the Install Spice button</li>
  <li>IE will prompt you with "This website wants to install the following add-on SpiceX.cab… proceed by clicking "Install this Add-on for All Users of this computer".</li>
  <li>Depending on the version of IE the next security warning may pop up asking you if you want to install SpiceX.cab" If it does not Click on the install spice button again and it will.</li>
  <li>In the security warning dialog click on the Install button.</li>
  <li>The install will now proceed in the background.</li>
  <li>If the install was successful there will now be an entry called "VirtViewer" in your start menu under "All Programs".</li>
  <li>The Spice Remote-Viewer Client/ActiveX Plugin is now installed and you will be able to view the consoles of your vm's in the User/Admin portals.</li>
</ul>

<h3 id="windows-vista-x86x64-windows-7-x86x64-server-2008r2-x86x64-clients">Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Clients</h3>

<ul>
  <li>Launch Internet Explorer and browse to your oVirt instance and according spice.html</li>
  <li>
    <p>Example URL
    http://ovirt.azeroth.net/spice.html</p>
  </li>
  <li>Click the install spice button</li>
  <li>IE will prompt you with "This website wants to install the following add-on SpiceX.cab… proceed by clicking the arrow on the install button and choose "Install for All Users of this computer".</li>
  <li>Depending on the version of IE a UAC dialog may pop up asking you if you want to allow "SpiceX.cab" If it does not Click on the install spice button again and it will.</li>
  <li>In the UAC dialog click on the yes button.</li>
  <li>The install will now proceed in the background.</li>
  <li>If the install was successful there will now be an entry called "VirtViewer" in your start menu under "All Programs"</li>
  <li>The Spice Remote-Viewer Client/ActiveX Plugin is now installed and you will be able to view the consoles of your vm's in the User/Admin portals.</li>
</ul>

<h2 id="manual-install-client-side">Manual Install Client Side</h2>

<h3 id="windows-xp-x86server-2003r2-x86x64-clients-1">Windows XP (x86)/Server 2003/R2 (x86/x64) Clients</h3>

<ul>
  <li>Launch Internet Explorer and browse to your oVirt instance and according spice.html</li>
  <li>
    <p>Example URL
    http://ovirt.azeroth.net/spice.html</p>
  </li>
  <li>Right-Click "Spice Remote-Viewer Client/ActiveX Plugin" and choose "save target as"</li>
  <li>Save the installer somewhere and note it's location</li>
  <li><strong>Important</strong> Close all open Internet Explorer windows/sessions!</li>
  <li>Go to the location where you saved the installer and double-click it to launch it</li>
  <li>A security warning will pop up warning of an un-verified publisher this is fine click on the run button to proceed</li>
  <li>In the resulting installation dialog click on the install button to proceed with the install</li>
  <li>Click the close button once it is done to complete the install</li>
  <li>The Spice Remote-Viewer Client/ActiveX Plugin is now installed and you will be able to view the consoles of your vm's in the User/Admin portals.</li>
</ul>

<h3 id="windows-vista-x86x64-windows-7-x86x64-server-2008r2-x86x64-clients-1">Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Clients</h3>

<ul>
  <li>Launch Internet Explorer and browse to your oVirt instance and according spice.html</li>
  <li>
    <p>Example URL
    http://ovirt.azeroth.net/spice.html</p>
  </li>
  <li>Right-Click "Spice Remote-Viewer Client/ActiveX Plugin" and choose "save target as"</li>
  <li>Save the installer somewhere and note it's location</li>
  <li><strong>Important</strong> Close all open Internet Explorer windows/sessions!</li>
  <li>Go to the location where you saved the installer and right-click it then choose "Run as Administrator"</li>
  <li>A UAC dialog will pop up asking you if you want to allow virt-viewer to install.</li>
  <li>In the UAC dialog click on the yes button.</li>
  <li>In the resulting installation dialog click on the install button to proceed with the install</li>
  <li>Click the close button once it is done to complete the install</li>
  <li>The Spice Remote-Viewer Client/ActiveX Plugin is now installed and you will be able to view the consoles of your vm's in the User/Admin portals.</li>
</ul>

<h2 id="un-installing-client-side">Un-Installing Client Side</h2>

<h3 id="windows-xp-x86server-2003r2-x86x64-clients-2">Windows XP (x86)/Server 2003/R2 (x86/x64) Clients</h3>

<ul>
  <li><strong>Important</strong> Close all open Internet Explorer windows/sessions!</li>
  <li>Click on the start menu</li>
  <li>Click "All Programs"</li>
  <li>Click "Accessories"</li>
  <li>Click "Command Prompt"</li>
  <li>In the command prompt window type "regsvr32 /u "C:\Documents and Settings\yourusernamehere\Local Settings\Application Data\virt-viewer\bin\SpiceX.dll"</li>
  <li>Next Click on the start menu</li>
  <li>Click "Control Panel"</li>
  <li>In the Control Panel run Add/Remove Programs</li>
  <li>Click on VirtViewer and click on Change/Remove</li>
  <li>The Spice Remote-Viewer Client/ActiveX Plugin is now uninstalled from the system</li>
</ul>

<h3 id="windows-vista-x86x64-windows-7-x86x64-server-2008r2-x86x64-clients-2">Windows Vista (x86/x64), Windows 7 (x86/x64), Server 2008/R2 (x86/x64) Clients</h3>

<ul>
  <li><strong>Important</strong> Close all open Internet Explorer windows/sessions!</li>
  <li>Click on the start menu</li>
  <li>Click "All Programs"</li>
  <li>Click "Accessories"</li>
  <li>Click "Command Prompt"</li>
  <li>In the command prompt window type "regsvr32 /u "C:\Users\yourusernamehere\AppData\Local\virt-viewer\bin\SpiceX.dll"</li>
  <li>Next Click on the start menu</li>
  <li>Click "Control Panel"</li>
  <li>In the Control Panel run "Programs and Features"</li>
  <li>Click on VirtViewer and click on Uninstall</li>
  <li>The Spice Remote-Viewer Client/ActiveX Plugin is now uninstalled from the system</li>
</ul>

<h2 id="windows-mouse">Windows Mouse</h2>

<p>When setting up new OS but before you install Windows client tools you might experience mouse problems. For example mouse keeps scrolling off the client window. This is confirmed to be now fixed by the Spice team and should show up in Windows client past version 0.5.3 Temporary work-arround is to:</p>

<ul>
  <li>Open Client Window</li>
  <li>Select Window (do not click inside yet)</li>
  <li>From the View menu select Full Screen or F-11</li>
  <li>Click inside the window</li>
</ul>

</section>
</section>
</section>
<footer class='text-center' id='footer'>
<hr class='visible-print'>
<ul class='footer-nav-list'>
<li><a target="_blank" href="/privacy/">Privacy policy</a></li>
<li><a target="_blank" href="/about/">About</a></li>
<li><a target="_blank" href="/disclaimers/">Disclaimers</a></li>
</ul>

&copy; 2013&ndash;2015 oVirt
<div class='last-modified'>
Page last modified
Mon 22 Jun 2015 10:08 UTC
</div>
</footer>


<script src="/javascripts/application.js?1447607928" type="text/javascript"></script>

<!-- eloqua -->
<script src='http://www.redhat.com/j/elqNow/elqCfg.js' type='text/javascript'></script>
<script src='http://www.redhat.com/j/elqNow/elqImg.js' type='text/javascript'></script>

</body>
</html>
