<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7" lang="en-us"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8" lang="en-us"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if IE 9]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if lt IE 10]> <html class="no-js lt-ie10" lang="en-us"> <![endif]-->
<!--[if !IE]> > <![endif]-->
<html class='no-js' lang='en'>
<!-- <![endif] -->
<head>
<title>
How to Connect to VNC Console Without Portal &mdash;
oVirt
</title>
<meta charset='utf-8'>
<meta content='' name='description'>
<meta content='' name='author'>
<meta content='initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width' name='viewport'>

<link href='/images/favicon.ico' rel='shortcut icon'>
<link href='/images/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'>
<link href='/images/apple-touch-icon-57x57-precomposed.png' rel='apple-touch-icon-precomposed' sizes='57x57'>
<link href='/images/apple-touch-icon-72x72-precomposed.png' rel='apple-touch-icon-precomposed' sizes='72x72'>
<link href='/images/apple-touch-icon-114x114-precomposed.png' rel='apple-touch-icon-precomposed' sizes='114x114'>
<link href="/stylesheets/application.css?1447607916" rel="stylesheet" type="text/css" />
<link href="/stylesheets/print.css?1447607916" rel="stylesheet" type="text/css" media="print" />
</head>
<body class=' source-md'>
<header class='masthead hidden-print' id='branding' role='banner'>
<section class='hgroup'>
<h1>
<a href="/"><img id="logo" class="logo is-svg" alt="oVirt" src="/images/logo.svg?1447607917" />
</a></h1>
</section>
<div id='access'>
<nav role='navigation'>
<ul class='nav nav-pills'>
<li class='nav-link-home' role='menuitem'>
<a href='/'>Home</a>
</li>

<li class='nav-link-download' role='menuitem'>
<a href='/download/'>Download</a>
</li>

<li class='nav-link-documentation' role='menuitem'>
<a href='/documentation/'>Documentation</a>
</li>

<li class='nav-link-community' role='menuitem'>
<a href='/community/'>Community</a>
</li>

<li class='nav-link-develop' role='menuitem'>
<a href='/develop/'>Develop</a>
</li>

<li class='nav-link-search' role='menuitem'>
<a href='/search/'>Search</a>
</li>

</ul>
</nav>

</div>
</header>

<section class='page-wrap' id='page-wrap'>
<section class='page' id='page'>
<section class='container content' id='content'>
<div class='alert alert-warning'>
<div class='pull-right'>
<a>Hover for more info</a>
</div>
<div class='frontmatter-metadata'>
<table class='metadata'>
<caption>Frontmatter Metadata</caption>
<tr>
<th>title</th>
<td>How to Connect to VNC Console Without Portal</td>
</tr>
<tr>
<th>category</th>
<td>howto</td>
</tr>
<tr>
<th>authors</th>
<td>dyasny</td>
</tr>
<tr>
<th>wiki_title</th>
<td>How to Connect to VNC Console Without Portal</td>
</tr>
<tr>
<th>wiki_revision_count</th>
<td>1</td>
</tr>
<tr>
<th>wiki_last_updated</th>
<td>2012-11-08</td>
</tr>
</table>
</div>
Original Wiki page:
<a href='http://ovirt.org/How_to_Connect_to_VNC_Console_Without_Portal' target='_blank'>
How to Connect to VNC Console Without Portal
</a>
</div>

<!--[if lt IE 7]>
<p class="chromeframe">You are using an outdated browser.
<a href="http://browsehappy.com/">Upgrade your browser today</a> or
<a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
<![endif]-->
<h1 id="how-to-connect-to-vnc-console-without-portal">How to Connect to VNC Console Without Portal</h1>

<p>This method has been tested with tigerVNC (vncviewer) client on RHEL and Fedora.</p>

<p>The client.conf file should contain the path and the executable for the VNC client:</p>

<pre class="highlight plaintext"><code> CLIENTPATH=/usr/bin/&#x000A; CLIENTEXEC=vncviewer&#x000A;</code></pre>

<p>Usage:</p>

<pre class="highlight plaintext"><code>         vncConnect.py - Locate a VM by name and open it's VNC console&#x000A;         Usage:  vncConnect.py | [arg].internal..[argN]&#x000A;         Options:&#x000A;         --help:                Print this help screen. `       --address=`&lt;FQDN or IP: Use non-default (127.0.0.1) IP to access&#x000A;      the RHEV-M API.&#x000A;    --port=&lt;PORT&gt;`:         Use non-default (443) port to access`&#x000A;           the RHEV-M API.&#x000A;         --user=`&lt;Username&gt;`:     Use non-default (admin@internal) username&#x000A;           to access RHEV-M API. Must use USER@DOMAIN&#x000A;         --password=`&lt;PASSWORD&gt;`: Enter the API user password&#x000A;         --vm=`&lt;VM NAME&gt;`:        Enter name of the requested VM&#x000A;         If no options are entered, or --password and/or --vm options are&#x000A;         missing, will enter interactive mode.&#x000A;</code></pre>

<p>vncClient.py <img alt="" title="fig:vncClient.bz2" src="/images/vncClient.bz2" />:</p>

<pre class="highlight python"><code><span class="c">#!/bin/env python</span>&#x000A;&#x000A;<span class="kn">import</span> <span class="nn">urllib2</span>&#x000A;<span class="kn">import</span> <span class="nn">sys</span>&#x000A;<span class="kn">import</span> <span class="nn">base64</span>&#x000A;<span class="kn">import</span> <span class="nn">os</span>&#x000A;<span class="kn">from</span> <span class="nn">xml.dom</span> <span class="kn">import</span> <span class="n">minidom</span>&#x000A;<span class="kn">import</span> <span class="nn">subprocess</span>&#x000A;<span class="kn">import</span> <span class="nn">getopt</span>&#x000A;<span class="kn">import</span> <span class="nn">traceback</span>&#x000A;<span class="kn">import</span> <span class="nn">random</span>&#x000A;&#x000A;<span class="k">def</span> <span class="nf">usage</span><span class="p">():</span>&#x000A;    <span class="k">print</span> <span class="s">"""&#x000A;        vncConnect.py - Locate a VM by name and open it's VNC console&#x000A;        Usage:  vncConnect.py | [arg].internal..[argN]&#x000A;        Options:&#x000A;        --help:                Print this help screen.&#x000A;        --address=&lt;FQDN or IP: Use non-default (127.0.0.1) IP to access&#x000A;          the RHEV-M API.&#x000A;        --port=&lt;PORT&gt;:         Use non-default (443) port to access&#x000A;          the RHEV-M API.&#x000A;        --user=&lt;Username&gt;:     Use non-default (admin@internal) username&#x000A;          to access RHEV-M API. Must use USER@DOMAIN&#x000A;        --password=&lt;PASSWORD&gt;: Enter the API user password&#x000A;        --vm=&lt;VM NAME&gt;:        Enter name of the requested VM&#x000A;&#x000A;        If no options are entered, or --password and/or --vm options are&#x000A;        missing, will enter interactive mode.&#x000A;    """</span>&#x000A;    <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>&#x000A;&#x000A;<span class="k">def</span> <span class="nf">APIcall</span><span class="p">(</span><span class="n">call</span><span class="p">):</span>&#x000A;    <span class="k">global</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASSWD</span><span class="p">,</span> <span class="n">APIURL</span>&#x000A;    <span class="n">URL</span> <span class="o">=</span> <span class="n">APIURL</span> <span class="o">+</span> <span class="n">call</span>&#x000A;    <span class="n">request</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>&#x000A;    <span class="n">base64string</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">encodestring</span><span class="p">(</span><span class="s">'</span><span class="si">%</span><span class="s">s:</span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">USER</span><span class="p">,</span> <span class="n">PASSWD</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>&#x000A;    <span class="n">request</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="s">"Basic </span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="n">base64string</span><span class="p">)</span>&#x000A;    <span class="c">#log('API GET called: ' + call)</span>&#x000A;    <span class="k">try</span><span class="p">:</span>&#x000A;        <span class="n">xmldata</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>&#x000A;    <span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">URLError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>&#x000A;        <span class="k">print</span> <span class="s">"Error: cannot connect to REST API: </span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span>&#x000A;        <span class="k">print</span> <span class="s">"Try to login using the same user/pass in Admin Portal</span><span class="se">\&#x000A;</span><span class="s">        and check the error!"</span>&#x000A;        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>&#x000A;    <span class="k">return</span> <span class="n">minidom</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">xmldata</span><span class="p">)</span>&#x000A;&#x000A;<span class="k">def</span> <span class="nf">APIpost</span><span class="p">(</span><span class="n">call</span><span class="p">,</span> <span class="n">postdata</span><span class="p">):</span>&#x000A;    <span class="k">global</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASSWD</span><span class="p">,</span> <span class="n">APIURL</span>&#x000A;    <span class="n">URL</span> <span class="o">=</span> <span class="n">APIURL</span> <span class="o">+</span> <span class="n">call</span>&#x000A;    <span class="n">request</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>&#x000A;    <span class="n">base64string</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">encodestring</span><span class="p">(</span><span class="s">'</span><span class="si">%</span><span class="s">s:</span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">USER</span><span class="p">,</span> <span class="n">PASSWD</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>&#x000A;    <span class="n">request</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="s">"Basic </span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="n">base64string</span><span class="p">)</span>&#x000A;    <span class="n">request</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'Content-Type'</span><span class="p">,</span> <span class="s">'application/xml'</span><span class="p">)</span>&#x000A;    <span class="c">#log('API POST called: ' + call + ' :: ' + postdata)</span>&#x000A;    <span class="k">try</span><span class="p">:</span>&#x000A;        <span class="n">xmldata</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">postdata</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>&#x000A;    <span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">URLError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>&#x000A;        <span class="k">print</span> <span class="s">"Error: cannot connect to REST API: </span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span>&#x000A;        <span class="k">print</span> <span class="s">"Try to login using the same user/pass in Admin Portal </span><span class="se">\&#x000A;</span><span class="s">        and check the error!"</span>&#x000A;        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>&#x000A;    <span class="k">return</span> <span class="n">minidom</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">xmldata</span><span class="p">)</span>&#x000A;&#x000A;<span class="k">def</span> <span class="nf">run</span><span class="p">():</span>&#x000A;    <span class="k">global</span> <span class="n">ADDR</span><span class="p">,</span> <span class="n">API_PORT</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASSWD</span>&#x000A;    <span class="n">xmldata</span> <span class="o">=</span> <span class="n">APIcall</span><span class="p">(</span><span class="s">'vms'</span><span class="p">)</span>&#x000A;    <span class="k">for</span> <span class="n">vm</span> <span class="ow">in</span> <span class="n">xmldata</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s">'vm'</span><span class="p">):</span>&#x000A;        <span class="k">if</span> <span class="n">vm</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s">'name'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">firstChild</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">VM</span><span class="p">:</span>&#x000A;            <span class="n">vmxml</span> <span class="o">=</span> <span class="n">vm</span>&#x000A;            <span class="k">break</span>&#x000A;&#x000A;    <span class="k">try</span><span class="p">:</span>&#x000A;        <span class="n">host</span> <span class="o">=</span> <span class="n">vmxml</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s">'address'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">firstChild</span><span class="o">.</span><span class="n">data</span>&#x000A;        <span class="n">port</span> <span class="o">=</span> <span class="n">vmxml</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s">'port'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">firstChild</span><span class="o">.</span><span class="n">data</span>&#x000A;    <span class="k">except</span> <span class="n">e</span><span class="p">:</span>&#x000A;        <span class="k">print</span> <span class="s">"Error: VM probably not running: </span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span>&#x000A;&#x000A;    <span class="k">if</span> <span class="n">vmxml</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s">'display'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span>\&#x000A;    <span class="n">getElementsByTagName</span><span class="p">(</span><span class="s">'type'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">firstChild</span><span class="o">.</span><span class="n">data</span> <span class="o">!=</span> <span class="s">'vnc'</span><span class="p">:</span>&#x000A;        <span class="k">print</span> <span class="s">"Error: VM is not using VNC"</span>&#x000A;        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>&#x000A;&#x000A;    <span class="n">vmid</span> <span class="o">=</span> <span class="n">vmxml</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>&#x000A;&#x000A;    <span class="n">ticket</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10000000</span><span class="p">,</span> <span class="mi">99999999</span><span class="p">)</span>&#x000A;    <span class="n">xml_request</span> <span class="o">=</span> <span class="s">"""&lt;action&gt;&#x000A;        &lt;ticket&gt;&#x000A;            &lt;value&gt;"""</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ticket</span><span class="p">)</span> <span class="o">+</span> <span class="s">"""&lt;/value&gt;&#x000A;               &lt;expiry&gt;60&lt;/expiry&gt;&#x000A;          &lt;/ticket&gt;&#x000A;        &lt;/action&gt;"""</span>&#x000A;    <span class="n">URL</span> <span class="o">=</span> <span class="s">'vms/'</span> <span class="o">+</span> <span class="n">vmid</span> <span class="o">+</span> <span class="s">'/ticket'</span>&#x000A;    <span class="n">APIpost</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">xml_request</span><span class="p">)</span>&#x000A;    <span class="k">return</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">ticket</span>&#x000A;&#x000A;<span class="k">def</span> <span class="nf">getArgs</span><span class="p">():</span>&#x000A;    <span class="k">global</span> <span class="n">ADDR</span><span class="p">,</span> <span class="n">API_PORT</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASSWD</span>&#x000A;    <span class="k">print</span> <span class="s">"Missing some options. Entering interactive mode..."</span>&#x000A;    <span class="n">i</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">'Enter the RHEV-M address ['</span> <span class="o">+</span> <span class="n">ADDR</span> <span class="o">+</span> <span class="s">']: '</span><span class="p">)</span>&#x000A;    <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>&#x000A;        <span class="n">ADDR</span> <span class="o">=</span> <span class="n">i</span>&#x000A;    <span class="n">i</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">'Enter the RHEV-M API port ['</span> <span class="o">+</span> <span class="n">API_PORT</span> <span class="o">+</span> <span class="s">']: '</span><span class="p">)</span>&#x000A;    <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>&#x000A;        <span class="n">API_PORT</span> <span class="o">=</span> <span class="n">i</span>&#x000A;    <span class="n">i</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">'Enter the RHEV-M API user name ['</span> <span class="o">+</span> <span class="n">USER</span> <span class="o">+</span> <span class="s">']: '</span><span class="p">)</span>&#x000A;    <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>&#x000A;        <span class="n">USER</span> <span class="o">=</span> <span class="n">i</span>&#x000A;    <span class="n">i</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">'Enter the RHEV-M API password ['</span> <span class="o">+</span> <span class="n">PASSWD</span> <span class="o">+</span> <span class="s">']: '</span><span class="p">)</span>&#x000A;    <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>&#x000A;        <span class="n">PASSWD</span> <span class="o">=</span> <span class="n">i</span>&#x000A;    <span class="n">i</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">'Enter the Virtual Machine name ['</span> <span class="o">+</span> <span class="n">VM</span> <span class="o">+</span> <span class="s">']: '</span><span class="p">)</span>&#x000A;    <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>&#x000A;        <span class="n">VM</span> <span class="o">=</span> <span class="n">i</span>&#x000A;&#x000A;<span class="k">def</span> <span class="nf">startVnc</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">ticket</span><span class="p">,</span> <span class="n">viewerpath</span><span class="p">,</span> <span class="n">viewerexec</span><span class="p">):</span>&#x000A;    <span class="n">cmd</span> <span class="o">=</span> <span class="s">"echo "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ticket</span><span class="p">)</span> <span class="o">+</span> <span class="s">" | /"</span> <span class="o">+</span> <span class="n">viewerpath</span> <span class="o">+</span> <span class="n">viewerexec</span> <span class="o">+</span> \&#x000A;    <span class="s">" "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">host</span><span class="p">)</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span class="s">" --passwdInput=true"</span>&#x000A;    <span class="c">#print cmd</span>&#x000A;    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>&#x000A;&#x000A;<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>&#x000A;    <span class="c">#Setting defaults, to be overriden by user</span>&#x000A;    <span class="n">API_PORT</span> <span class="o">=</span> <span class="s">"443"</span>&#x000A;    <span class="n">USER</span> <span class="o">=</span> <span class="s">"admin@internal"</span>&#x000A;    <span class="n">ADDR</span> <span class="o">=</span> <span class="s">"127.0.0.1"</span>&#x000A;    <span class="n">PASSWD</span> <span class="o">=</span> <span class="s">""</span>&#x000A;    <span class="n">VM</span> <span class="o">=</span> <span class="s">""</span>&#x000A;    <span class="n">CONF</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="s">"/client.conf"</span>&#x000A;    <span class="n">VPATH</span> <span class="o">=</span> <span class="s">"None"</span>&#x000A;    <span class="n">VEXEC</span> <span class="o">=</span> <span class="s">"None"</span>&#x000A;&#x000A;    <span class="k">try</span><span class="p">:</span>&#x000A;        <span class="n">v</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">CONF</span><span class="p">)</span>&#x000A;    <span class="k">except</span> <span class="nb">SystemExit</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>&#x000A;        <span class="k">raise</span> <span class="n">e</span>&#x000A;        <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>&#x000A;&#x000A;    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>&#x000A;        <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'='</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">"CLIENTPATH"</span><span class="p">:</span>&#x000A;            <span class="n">VPATH</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'='</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>&#x000A;        <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'='</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">"CLIENTEXEC"</span><span class="p">:</span>&#x000A;            <span class="n">VEXEC</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'='</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>&#x000A;        <span class="k">else</span><span class="p">:</span>&#x000A;            <span class="k">print</span> <span class="s">"Wrong configuration value encountered"</span>&#x000A;&#x000A;    <span class="k">if</span> <span class="n">VPATH</span> <span class="o">==</span> <span class="s">"None"</span> <span class="ow">or</span> <span class="n">VEXEC</span> <span class="o">==</span> <span class="s">"None"</span><span class="p">:</span>&#x000A;        <span class="k">print</span> <span class="s">"Configuration values for CLIENTEXEC or CLIENTPATH </span><span class="se">\&#x000A;</span><span class="s">        missing in "</span> <span class="o">+</span> <span class="n">CONF</span>&#x000A;        <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>&#x000A;&#x000A;    <span class="k">try</span><span class="p">:</span>&#x000A;        <span class="n">opts</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">getopt</span><span class="o">.</span><span class="n">getopt</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s">"h"</span><span class="p">,</span> \&#x000A;        <span class="p">[</span><span class="s">'help'</span><span class="p">,</span> <span class="s">'address='</span><span class="p">,</span> <span class="s">'port='</span><span class="p">,</span> <span class="s">'user='</span><span class="p">,</span> <span class="s">'password='</span><span class="p">,</span> <span class="s">'vm='</span><span class="p">])</span>&#x000A;        <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>&#x000A;            <span class="c">#print (o,v)</span>&#x000A;            <span class="k">if</span> <span class="n">o</span> <span class="o">==</span> <span class="s">"-h"</span> <span class="ow">or</span> <span class="n">o</span> <span class="o">==</span> <span class="s">"--help"</span><span class="p">:</span>&#x000A;                <span class="n">usage</span><span class="p">()</span>&#x000A;                <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>&#x000A;            <span class="k">elif</span> <span class="n">o</span> <span class="o">==</span> <span class="s">'--address'</span><span class="p">:</span>&#x000A;                <span class="n">ADDR</span> <span class="o">=</span> <span class="n">v</span>&#x000A;            <span class="k">elif</span> <span class="n">o</span> <span class="o">==</span> <span class="s">'--port'</span><span class="p">:</span>&#x000A;                <span class="n">API_PORT</span> <span class="o">=</span> <span class="n">v</span>&#x000A;            <span class="k">elif</span> <span class="n">o</span> <span class="o">==</span> <span class="s">'--user'</span><span class="p">:</span>&#x000A;                <span class="n">USER</span> <span class="o">=</span> <span class="n">v</span>&#x000A;            <span class="k">elif</span> <span class="n">o</span> <span class="o">==</span> <span class="s">'--password'</span><span class="p">:</span>&#x000A;                <span class="n">PASSWD</span> <span class="o">=</span> <span class="n">v</span>&#x000A;            <span class="k">elif</span> <span class="n">o</span> <span class="o">==</span> <span class="s">'--vm'</span><span class="p">:</span>&#x000A;                <span class="n">VM</span> <span class="o">=</span> <span class="n">v</span>&#x000A;            <span class="k">else</span><span class="p">:</span>&#x000A;                <span class="k">print</span> <span class="s">"Wrong argument "</span> <span class="o">+</span> <span class="n">v</span>&#x000A;                <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>&#x000A;&#x000A;    <span class="k">except</span> <span class="nb">SystemExit</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>&#x000A;        <span class="k">raise</span> <span class="n">e</span>&#x000A;    <span class="k">except</span><span class="p">:</span>&#x000A;        <span class="k">print</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>&#x000A;        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>&#x000A;&#x000A;    <span class="k">if</span> <span class="n">PASSWD</span> <span class="o">==</span> <span class="s">""</span> <span class="ow">or</span> <span class="n">VM</span> <span class="o">==</span> <span class="s">""</span><span class="p">:</span>&#x000A;        <span class="n">getArgs</span><span class="p">()</span>&#x000A;&#x000A;    <span class="n">APIURL</span> <span class="o">=</span> <span class="s">'https://'</span> <span class="o">+</span> <span class="n">ADDR</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">API_PORT</span> <span class="o">+</span> <span class="s">'/api/'</span>&#x000A;&#x000A;    <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">ticket</span> <span class="o">=</span> <span class="n">run</span><span class="p">()</span>&#x000A;    <span class="n">startVnc</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">ticket</span><span class="p">,</span> <span class="n">VPATH</span><span class="p">,</span> <span class="n">VEXEC</span><span class="p">)</span>&#x000A;&#x000A;    <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>&#x000A;</code></pre>

</section>
</section>
</section>
<footer class='text-center' id='footer'>
<hr class='visible-print'>
<ul class='footer-nav-list'>
<li><a target="_blank" href="/privacy/">Privacy policy</a></li>
<li><a target="_blank" href="/about/">About</a></li>
<li><a target="_blank" href="/disclaimers/">Disclaimers</a></li>
</ul>

&copy; 2013&ndash;2015 oVirt
<div class='last-modified'>
Page last modified
Mon 22 Jun 2015 10:08 UTC
</div>
</footer>


<script src="/javascripts/application.js?1447607928" type="text/javascript"></script>

<!-- eloqua -->
<script src='http://www.redhat.com/j/elqNow/elqCfg.js' type='text/javascript'></script>
<script src='http://www.redhat.com/j/elqNow/elqImg.js' type='text/javascript'></script>

</body>
</html>
