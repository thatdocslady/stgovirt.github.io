<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7" lang="en-us"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8" lang="en-us"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if IE 9]> <html class="no-js lt-ie10 lt-ie9" lang="en-us"> <![endif]-->
<!--[if lt IE 10]> <html class="no-js lt-ie10" lang="en-us"> <![endif]-->
<!--[if !IE]> > <![endif]-->
<html class='no-js' lang='en'>
<!-- <![endif] -->
<head>
<title>
GenericNodeRegistration &mdash;
oVirt
</title>
<meta charset='utf-8'>
<meta content='' name='description'>
<meta content='' name='author'>
<meta content='initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width' name='viewport'>

<link href='/images/favicon.ico' rel='shortcut icon'>
<link href='/images/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'>
<link href='/images/apple-touch-icon-57x57-precomposed.png' rel='apple-touch-icon-precomposed' sizes='57x57'>
<link href='/images/apple-touch-icon-72x72-precomposed.png' rel='apple-touch-icon-precomposed' sizes='72x72'>
<link href='/images/apple-touch-icon-114x114-precomposed.png' rel='apple-touch-icon-precomposed' sizes='114x114'>
<link href="/stylesheets/application.css?1447607916" rel="stylesheet" type="text/css" />
<link href="/stylesheets/print.css?1447607916" rel="stylesheet" type="text/css" media="print" />
</head>
<body class=' source-md'>
<header class='masthead hidden-print' id='branding' role='banner'>
<section class='hgroup'>
<h1>
<a href="/"><img id="logo" class="logo is-svg" alt="oVirt" src="/images/logo.svg?1447607917" />
</a></h1>
</section>
<div id='access'>
<nav role='navigation'>
<ul class='nav nav-pills'>
<li class='nav-link-home' role='menuitem'>
<a href='/'>Home</a>
</li>

<li class='nav-link-download' role='menuitem'>
<a href='/download/'>Download</a>
</li>

<li class='nav-link-documentation' role='menuitem'>
<a href='/documentation/'>Documentation</a>
</li>

<li class='nav-link-community' role='menuitem'>
<a href='/community/'>Community</a>
</li>

<li class='nav-link-develop' role='menuitem'>
<a href='/develop/'>Develop</a>
</li>

<li class='nav-link-search' role='menuitem'>
<a href='/search/'>Search</a>
</li>

</ul>
</nav>

</div>
</header>

<section class='page-wrap' id='page-wrap'>
<section class='page' id='page'>
<section class='container content' id='content'>
<div class='alert alert-warning'>
<div class='pull-right'>
<a>Hover for more info</a>
</div>
<div class='frontmatter-metadata'>
<table class='metadata'>
<caption>Frontmatter Metadata</caption>
<tr>
<th>title</th>
<td>GenericNodeRegistration</td>
</tr>
<tr>
<th>category</th>
<td>node</td>
</tr>
<tr>
<th>authors</th>
<td>alonbl, rbarry</td>
</tr>
<tr>
<th>wiki_category</th>
<td>Feature</td>
</tr>
<tr>
<th>wiki_title</th>
<td>Features/Node/GenericNodeRegistration</td>
</tr>
<tr>
<th>wiki_revision_count</th>
<td>8</td>
</tr>
<tr>
<th>wiki_last_updated</th>
<td>2014-05-21</td>
</tr>
</table>
</div>
Original Wiki page:
<a href='http://ovirt.org/Features/Node/GenericNodeRegistration' target='_blank'>
Features/Node/GenericNodeRegistration
</a>
</div>

<!--[if lt IE 7]>
<p class="chromeframe">You are using an outdated browser.
<a href="http://browsehappy.com/">Upgrade your browser today</a> or
<a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
<![endif]-->
<h1 id="generic-node-registration">Generic Node Registration</h1>

<h3 id="summary">Summary</h3>

<p>This will provide a generic, extensible way for Node to register to management servers.</p>

<h3 id="owner">Owner</h3>

<ul>
  <li>Name: <span class='broken-link link-mediawiki' data-href='User:rbarry' title='Special MediaWiki link: original pointed to: User:rbarry'> Ryan Barry</span></li>
</ul>

<!-- -->

<ul>
  <li>Email: rbarry AT redhat DOT com</li>
  <li>IRC: rbarry</li>
</ul>

<h3 id="current-status">Current status</h3>

<ul>
  <li>Development 50% complete</li>
  <li>Link to feature page in a specific release. That release may complete the feature, or parts of it. The complete scope of this feature in this release will be described in the release feature page</li>
  <li>Last updated: ,</li>
</ul>

<h3 id="detailed-description">Detailed Description</h3>

<p>The current registration process for oVirt Node relies upon vdsm-reg, which relies on configuration-as-code and is not suitable for other managers. Generic registration will provide a registration process which relies on structured data (YAML or JSON) to describe steps and parameters for execution.</p>

<h3 id="benefit-to-ovirt">Benefit to oVirt</h3>

<p>Increased agility, easier integration into other projects.</p>

<h3 id="dependencies--related-features">Dependencies / Related Features</h3>

<ul>
  <li>Affected Packages
    <ul>
      <li>ovirt-node</li>
    </ul>
  </li>
</ul>

<h3 id="documentation--external-references">Documentation / External references</h3>

<p>The code for vdsm-reg and the <a href="/feature/engine/hostdeployprotocol/">Features/HostDeployProtocol</a> describe the other end of the process.</p>

<p>Draft spec is:</p>

<pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"register"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;        </span><span class="s2">"steps"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> &#x000A;            </span><span class="p">{</span><span class="w">&#x000A;                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"get_ca"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"get"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;                    </span><span class="s2">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"engine.example.com"</span><span class="p">,</span><span class="w">&#x000A;                    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://{host}/url?cmd=get-ca-roots"</span><span class="p">,</span><span class="w">&#x000A;                    </span><span class="s2">"filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/etc/pki/ovirt-engine.key"</span><span class="w">&#x000A;                </span><span class="p">}</span><span class="w">&#x000A;            </span><span class="p">},</span><span class="w">&#x000A;            </span><span class="p">{</span><span class="w">&#x000A;                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"approve"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ui"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;                    </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OVIRT_ENGINE_FINGERPRINT"</span><span class="w">&#x000A;                </span><span class="p">}</span><span class="w">&#x000A;            </span><span class="p">},</span><span class="w">&#x000A;            </span><span class="p">{</span><span class="w">&#x000A;                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"persist_ca"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"persist"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;                    </span><span class="s2">"file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/etc/pki/ovirt-engine.key"</span><span class="w">&#x000A;                </span><span class="p">}</span><span class="w">&#x000A;            </span><span class="p">},</span><span class="w">&#x000A;            </span><span class="p">{</span><span class="w">&#x000A;                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"get_ssh"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"get"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;                    </span><span class="s2">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"engine.example.com"</span><span class="p">,</span><span class="w">&#x000A;                    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://{host}/url?=cmd=get-sshkey&amp;type=manager"</span><span class="p">,</span><span class="w">&#x000A;                    </span><span class="s2">"filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/tmp/ovirt-engine.key"</span><span class="w">&#x000A;                </span><span class="p">}</span><span class="w">&#x000A;            </span><span class="p">},</span><span class="w">&#x000A;            </span><span class="p">{</span><span class="w">&#x000A;                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"authorize"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"exec"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;                    </span><span class="s2">"cmd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cat/tmp/ovirt-engine.key&gt;&gt;/home/admin/.ssh/.authorized_keys"</span><span class="w">&#x000A;                </span><span class="p">}</span><span class="w">&#x000A;            </span><span class="p">},</span><span class="w">&#x000A;            </span><span class="p">{</span><span class="w">&#x000A;                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"persist_ssh"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"persist"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;                    </span><span class="s2">"file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/home/admin/.ssh/.authorized_keys"</span><span class="w">&#x000A;                </span><span class="p">}</span><span class="w">&#x000A;            </span><span class="p">},</span><span class="w">&#x000A;            </span><span class="p">{</span><span class="w">&#x000A;                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"finish"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"get"</span><span class="p">,</span><span class="w">&#x000A;                </span><span class="s2">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;                    </span><span class="s2">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"engine.example.com"</span><span class="p">,</span><span class="w">&#x000A;                    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://{host}/url?cmd=register&amp;name={name}&amp;ip={ip}&amp;sshkeyfingerprint={fingerprint}&amp;user={user}"</span><span class="p">,</span><span class="w">&#x000A;                    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node.example.com"</span><span class="p">,</span><span class="w">&#x000A;                    </span><span class="s2">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.0.0.1"</span><span class="p">,</span><span class="w">&#x000A;                    </span><span class="s2">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DE:AD:BE:EF"</span><span class="p">,</span><span class="w">&#x000A;                    </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="w">&#x000A;                </span><span class="p">}</span><span class="w">&#x000A;            </span><span class="p">}</span><span class="w">&#x000A;        </span><span class="p">]</span><span class="w">&#x000A;    </span><span class="p">}</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre>

<h3 id="comments-and-discussion">Comments and Discussion</h3>

<p>This below adds a link to the "discussion" tab associated with your page. This provides the ability to have ongoing comments or conversation without bogging down the main feature page</p>

<ul>
  <li>Refer to <a href="Talk:Generic Node Registration">Talk:Generic Node Registration</a></li>
</ul>

<category:feature> <category:template> <category:node>
</category:node></category:template></category:feature>

</section>
</section>
</section>
<footer class='text-center' id='footer'>
<hr class='visible-print'>
<ul class='footer-nav-list'>
<li><a target="_blank" href="/privacy/">Privacy policy</a></li>
<li><a target="_blank" href="/about/">About</a></li>
<li><a target="_blank" href="/disclaimers/">Disclaimers</a></li>
</ul>

&copy; 2013&ndash;2015 oVirt
<div class='last-modified'>
Page last modified
Wed 11 Nov 2015 18:11 UTC
</div>
</footer>


<script src="/javascripts/application.js?1447607928" type="text/javascript"></script>

<!-- eloqua -->
<script src='http://www.redhat.com/j/elqNow/elqCfg.js' type='text/javascript'></script>
<script src='http://www.redhat.com/j/elqNow/elqImg.js' type='text/javascript'></script>

</body>
</html>
